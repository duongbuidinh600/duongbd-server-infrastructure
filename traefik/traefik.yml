api:
  dashboard: true
  insecure: true

providers:
  docker:
    exposedByDefault: false
    network: scangoo-network
    swarmMode: false

entryPoints:
  web:
    address: ":80"
    http:
      redirections:
        entryPoint:
          to: websecure
          scheme: https
          permanent: true

  websecure:
    address: ":443"
    http:
      middlewares:
        - security-headers@file

# TLS configuration (for local services)
tls:
  stores:
    default:
      defaultCertificate:
        certFile: /etc/traefik/certs/cert.pem
        keyFile: /etc/traefik/certs/key.pem
  options:
    default:
      minVersion: "VersionTLS12"

# Global security headers
http:
  middlewares:
    security-headers:
      headers:
        browserXssFilter: true
        contentTypeNosniff: true
        forceSTSHeader: true
        stsIncludeSubdomains: true
        stsPreload: true
        stsSeconds: 31536000
        frameDeny: true
        referrerPolicy: "strict-origin-when-cross-origin"

    compression:
      compress: {}

    rate-limit:
      rateLimit:
        average: 100
        burst: 50

    admin-auth:
      basicAuth:
        users:
          - "admin:$apr1$cV6C2B8E$XqGjHe2ZK8nVkr9hVZFIW1"

# Logging configuration
log:
  level: INFO
  format: json

accessLog:
  format: json
  bufferingSize: 100

# Metrics and health checks
metrics:
  prometheus:
    addEntryPointsLabels: true
    addServicesLabels: true

ping:
  entryPoint: "traefik"